{% extends 'base.html'%}
{% load static %}
{% block content %}
{% load static %}
{% load crispy_forms_tags %}
<!-- Trends over time (daily, weekly, monthly) -->
<!-- Header -->
<header class="py-5">
    <div class="container px-5">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-xxl-6">
                <div class="text-center my-5">
                    <h1 class="fw-bolder mb-3">Our mission is to make dietary tracking easier for those with stage 3/4 chronic kidney disease.</h1>
                    <p class="lead fw-normal text-muted mb-4">kDIET is here to help provide an easy way to input food and get real time data of food levels as well as recommendations to help you preserve your kidney</p>
                    <a class="btn btn-primary btn-lg" href={% url 'faq' %}>Read our story</a>
                </div>
            </div>
        </div>
    </div>
    <!-- this will be the link to our chart -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>r
</header>

<!-- serum levels form -->
<div class = "border p-3 shadow">
    <h4>Add Serum Levels</h4>
    <hr>
    <form method="POST">
      <br>
        {% csrf_token %}
        {{ form | crispy }}
        <input type="hidden" id="username" name="username" value="{{user.username}}">
        <br>
        <input class = 'btn btn-success btn-block' type='submit' value = 'Add'>
    </form>
</div>

<!-- blood sugar visualization section -->
<canvas id="myChart" width="400" height="400"></canvas>
<script>
var ctx = document.getElementById("myChart").getContext("2d");
    
    var dataFirst = {
        label: "Potassium Levels",
        data: [{% for data in data %}{{data.potassium_level}},{% endfor %}],
        lineTension: 0,
        fill: false,
        borderColor: 'red'
      };
    
    var dataSecond = {
        label: "Phosphorus Levels",
        data: [{% for data in data %}{{data.phosphorus_level}},{% endfor %}],
        lineTension: 0,
        fill: false,
        borderColor: 'blue'
      };
    
    var dataThird = {
        label: "Sodium levels",
        data: [{% for data in data %}{{data.sodium_level}},{% endfor %}],
        lineTension: 0,
        fill: false,
        borderColor: 'green'
      };
    
    var dataFourth = {
        label: "Calcium levels",
        data: [{% for data in data %}{{data.calcium_level}},{% endfor %}],
        lineTension: 0,
        fill: false,
        borderColor: 'yellow'
      };
    
    var dataFifth = {
        label: "Blood Sugar levels",
        data: [{% for data in data %}{{data.blood_sugar_level}},{% endfor %}],
        lineTension: 0,
        fill: false,
        borderColor: 'purple'
      };
    
    var lineChart = {
      labels: [{% for data in data %}'{{data.results_date}}',{% endfor %}],
      datasets: [dataFirst, dataSecond, dataThird, dataFourth, dataFifth]
    };
    
    var chartOptions = {
      legend: {
        display: true,
        position: 'top',
        labels: {
          boxWidth: 80,
          fontColor: 'black'
        }
      }
    };
    
    var myChart = new Chart(ctx, {
      type: 'line',
      data: lineChart,
      options: chartOptions
    });
    
</script>
{% endblock %}